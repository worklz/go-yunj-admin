layui.define(["jquery","yunj","FormBuild"],function(e){let t=window;let l=document;let d=layui.jquery;let i=layui.FormBuild;class a extends i{constructor(e){super(e,"field");this.loadValues={};this.fields={}}_initBuildBoxEl(){let e=this;let t="";if(!e.isSetTab()){t=`style="padding:0;"`}e.form.tabBoxEl.append(`<ul class="layui-tab-content" ${t}></ul>`);e.buildBoxEl=e.form.tabBoxEl.find(".layui-tab-content")}async render(){let t=this;t.loadValues=t.form.rawArgs.loadValues;if(t.isSetTab()){for(let e in t.form.rawArgs.tab){if(!t.buildArgs.hasOwnProperty(e))continue;t._setFieldsLayout(e);await t._renderFields(t.buildArgs[e],e)}}else{t._setFieldsLayout();await t._renderFields(t.buildArgs)}t.buildBoxEl.find(".layui-tab-item:first").addClass("layui-show");t._setFieldsItemStyle()}_setFieldsLayout(e=""){let t=this;t.buildBoxEl.append(`<div class="layui-tab-item"><form class="layui-form layui-form-pane yunj-form" lay-filter="${t.formId+(e?`_${e}`:"")}"><div class="layui-row"></div></form></div>`)}async _renderFields(t,i=""){let a=this;let d=a.loadValues;for(let l in t){if(!t.hasOwnProperty(l))continue;let e=t[l];if(yunj.isObj(d)&&d.hasOwnProperty(l)){e.value=d[l];delete d[l]}await new Promise(t=>{yunj.formField(e.type,{formId:a.formId,tab:i,key:l,args:e}).then(e=>{return e.render(`.layui-tab[lay-filter=${a.formId}_tab] .layui-tab-content .yunj-form[lay-filter=${a.formId+(i?`_${i}`:"")}] > .layui-row`)}).then(e=>{a.fields[e.id]=e;t()}).catch(e=>{console.log(e);t()})})}}_setFieldsItemStyle(){let a=this;if(!yunj.isMobile()){let t=0;let e=a.buildBoxEl.find(".layui-tab-item.layui-show .yunj-form-item:not(.yunj-form-item-label-width-fill,:has(.yunj-form-item-label-width-fill))");e.find(".layui-form-label").css("width","auto");e.each(function(){let e=d(this).find(".layui-form-label").outerWidth();if(e>t)t=e});let l=1;let i=t+l;e.find(".layui-form-label").css("width",i+"px")}}_setFieldsMarkdownEditormdReload(){let l=this;let i=l.buildArgs[l.getCurrTab()];for(let t in i){if(!i.hasOwnProperty(t)){continue}if(i[t].type!=="markdown"||i[t].hasOwnProperty("mode")&&i[t].mode!=="editormd")continue;let e=l.fields[l.formId+(l.getCurrTab()?`_${l.getCurrTab()}`:"")+`_${t}`];e&&e.hasOwnProperty("reloadEditormd")&&e.reloadEditormd()}}setEventBind(){let t=this;if(t.isSetTab()){d(l).bind(`yunj_form_${t.formId}_tab_change`,function(e){t._setFieldsItemStyle();t._setFieldsMarkdownEditormdReload()})}}}e("FormBuildField",a)});