layui.define(["jquery","yunj"],function(e){let t=window;let l=document;let i=layui.jquery;class r{constructor(e={}){this.options=e;this.form=e.form;this.formId=e.formId;this.tab=e.tab;this.key=e.key;this.id=null;this.args={};this.tabFormFilter=null;this.boxHtml=null;this.boxEl=null;this._init()}_init(){let e=this;e._setData()}_setData(){let e=this;e._setId();e._setArgs();e._setTabFormFilter();e._setBoxHtml()}_setId(){let e=this;e.id=yunj.generateFormFieldId(e.formId,e.key)}_setArgs(){let e=this;let t=Object.assign({title:"",default:"",desc:"",verify:"",verifyTitle:"",readonly:false,grid:[]},e.defineExtraArgs(),e.options.args);t=e.handleArgs(t);e.args=t}defineExtraArgs(){return{}}handleArgs(e){return e}_setTabFormFilter(){let e=this;let t=e.formId+(e.tab?`_${e.tab}`:"");let r=i(`[lay-filter=${t}]`);if(r.length<=0){let e=`lay-filter=${t}的表单容器不存在`;yunj.alert(e);throw new Error(e)}if(!r.hasClass("layui-form"))r.addClass("layui-form");e.tabFormFilter=t}_setBoxHtml(){let e=this;e.boxHtml=e.defineBoxHtml()}defineBoxHtml(){let e=this;return`<div class="layui-form-item yunj-form-item yunj-form-${e.args.type} ${e.isReadonly()?"readonly":""}" id="${e.id}">__layout__</div>`}_getInitValue(){let e=this;return e.args.hasOwnProperty("value")?e.args.value:e.args.default}async render(e,t=""){let r=this;await r.renderBefore();i(e).append(r._layout(t));r.boxEl=i(`#${r.id}`);await r.renderDone();i(l).trigger(`yunj_form_${r.formId}_${r.key}_render_done`,[r]);r.renderDoneSetValue(r._getInitValue());r._setEventBind();return r}_layout(e=""){let t=this;let r=t.boxHtml.replace("__layout__",t.layoutContent());if(e&&e.indexOf("__layout__")!==-1){r=e.replace("__layout__",r)}let l=yunj.generateGridClass(t.args.grid);r=`<div${l?` class="${l}"`:""}>${r}</div>`;return r}layoutContent(){let e=this;let t="";t+=e.layoutLabel();t+=e.layoutControl();return t}layoutLabel(){let e=this;let t="";let r=e.args.title;if(!r)return t;if(e.args.verify&&e.args.verify.indexOf("require")!==-1)t+=`<span class="require">*</span>`;t+=r;if(e.descContent()){t+=`<i class="layui-icon layui-icon-tips desc-icon" title="${r}字段说明"></i>`}return`<label class="layui-form-label" title="${r}">${t}</label>`}layoutControl(){}descContent(){let e=this;return e.args.desc?e.args.desc:""}async renderBefore(){return"done"}async renderDone(){return"done"}renderDoneSetValue(e){let t=this;t.setValue(e)}setValue(e=""){}getValue(){}isEmptyValue(){let e=this;let t=e.getValue();return t===""||t===null||t==={}||t===[]||t===undefined}_setEventBind(){let n=this;i(l).bind(`yunj_form_${n.formId}_clear`,function(e){n.setValue("")});i(l).bind(`yunj_form_${n.formId}_reset`,function(e){n.setValue(n._getInitValue())});i(l).bind(`yunj_form_${n.formId}_submit`,function(e,t,r){let l=n.key;let i=n.getValue();if(n.args.readonly){return}t[l]=i;if(!r.enable||!n.args.verify){return}r.rule[l]=n.args.verify;r.data[l]=i;r.dataTitle[l]=n.args.verifyTitle||n.args.title||l});n.boxEl.on("click","label .desc-icon",function(e){e.stopPropagation();yunj.alert(`<div class="yunj-form-item-desc">${n.descContent()}</div>`,{title:`字段说明：${n.args.title}`})});n.defineExtraEventBind()}defineExtraEventBind(){}isReadonly(){return!!this.args.readonly}}e("FormField",r)});