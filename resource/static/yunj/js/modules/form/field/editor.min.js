layui.define(["FormField","yunj"],function(e){let t=layui.FormField;class i extends t{constructor(e={}){super(e);this.mode=null;this.editor_id=null;this.editor=null}defineExtraArgs(){let e=this;return{mode:"ckeditor",modeConfig:{ckeditor:{toolbar:["Source","-","Undo","Redo","-","Preview","-","SelectAll","-","Bold","Italic","Underline","Strike","-","NumberedList","BulletedList","-","JustifyLeft","JustifyCenter","JustifyRight","JustifyBlock","-","BidiLtr","BidiRtl","-","Link","Image","CodeSnippet","-","Styles","Format","Font","FontSize","-","TextColor","BGColor","-","Maximize"]}}}}handleArgs(e){let t=this;let i=e.mode;let r=e.modeConfig;let o=t.defineExtraArgs().modeConfig;if(!r.hasOwnProperty(i)){r[i]=o[i];e.modeConfig=r;return e}r[i]=Object.assign({},o[i],r[i]);if(i==="ckeditor"){r[i].toolbar=yunj.arrayIntersect(r[i].toolbar,o[i].toolbar)}e.modeConfig=r;return e}defineBoxHtml(){let e=this;return`<div class="layui-form-item yunj-form-item yunj-form-item-label-width-fill" id="${e.id}">__layout__</div>`}layoutControl(){let e=this;return e[`layout_control_${e.mode}`]()}async renderBefore(){let e=this;e.mode=e.args.mode;e.editor_id=`${e.id}_editor_${e.mode}`;await e[`render_before_${e.mode}`]();return"done"}renderDone(){let e=this;e[`render_done_${e.mode}`]()}setValue(e=""){let t=this;t[`set_value_${t.mode}`](e)}getValue(){let e=this;return e[`get_value_${e.mode}`]()}layout_control_ckeditor(){let e=this;return`<div class="layui-input-inline yunj-form-item-control"><textarea id="${e.editor_id}"></textarea></div>`}async render_before_ckeditor(){let e=this;await yunj.includeJs("/static/yunj/libs/ckeditor/ckeditor.js");return"done"}render_done_ckeditor(){let e=this;CKEDITOR.replace(e.editor_id,{filebrowserUploadUrl:yunj.fileUploadUrl("ckeditor"),filebrowserImageUploadUrl:yunj.fileUploadUrl("ckeditor"),toolbar:[{name:"init",items:e.args.modeConfig.ckeditor.toolbar}],readOnly:e.args.readonly});e.editor=CKEDITOR.instances[e.editor_id]}set_value_ckeditor(e=""){let t=this;t.editor.setData(e)}get_value_ckeditor(){let e=this;return e.editor.getData()}}e("FormFieldEditor",i)});