layui.define(["jquery","layer","md5"],function(e){let l=window;let y=document;let c=layui.jquery;let d=layui.layer;let n=layui.md5;class t{constructor(){this.version=l.YUNJ_VERSION;this.icon={warn:0,success:1,error:2,quiz:3,lock:4,sad:5,smile:6,load:16};this.defaultRegex={url:/^((https|http|ftp|rtsp|mms)?:\/\/)[^\s]+/,uri:/^\/[^\s]+/,commaIntervalPositiveInt:/^[1-9]\d*(?:,[1-9]\d*)*$/,commaIntervalChsAlphaNum:/^[\u4e00-\u9fa5a-zA-Z0-9]+(?:,[\u4e00-\u9fa5a-zA-Z0-9]+)*$/,hexColor:/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,alphaDash:/^[A-Za-z0-9\_\-]+$/,alphaNum:/^[A-Za-z0-9]+$/,chsDashSpace:/^[\u4e00-\u9fa5a-zA-Z0-9\_\-\s]+$/,chsDash:/^[\u4e00-\u9fa5a-zA-Z0-9\_\-]+$/,chsAlphaNum:/^[\u4e00-\u9fa5a-zA-Z0-9]+$/,chs:/^[\u4e00-\u9fa5]+$/,email:/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/,mobile:/^1[3-9]\d{9}$/,number:/^[0-9]*$/,integer:/^(-?[1-9]\d*|0)$/,nonnegativeNum:/^(0|[1-9]\d*)(\.\d+)?$/,ip:/^((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([\da-fA-F]{1,4}:){6}((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^::([\da-fA-F]{1,4}:){0,4}((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([\da-fA-F]{1,4}:):([\da-fA-F]{1,4}:){0,3}((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([\da-fA-F]{1,4}:){2}:([\da-fA-F]{1,4}:){0,2}((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([\da-fA-F]{1,4}:){3}:([\da-fA-F]{1,4}:){0,1}((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([\da-fA-F]{1,4}:){4}:((25[0-5]|2[0-4]\d|[01]?\d\d?)\.){3}(25[0-5]|2[0-4]\d|[01]?\d\d?)$|^([\da-fA-F]{1,4}:){7}[\da-fA-F]{1,4}$|^:((:[\da-fA-F]{1,4}){1,6}|:)$|^[\da-fA-F]{1,4}:((:[\da-fA-F]{1,4}){1,5}|:)$|^([\da-fA-F]{1,4}:){2}((:[\da-fA-F]{1,4}){1,4}|:)$|^([\da-fA-F]{1,4}:){3}((:[\da-fA-F]{1,4}){1,3}|:)$|^([\da-fA-F]{1,4}:){4}((:[\da-fA-F]{1,4}){1,2}|:)$|^([\da-fA-F]{1,4}:){5}:([\da-fA-F]{1,4})?$|^([\da-fA-F]{1,4}:){6}:$/};this.init()}init(){let e=this;e.defineGlobal()}defineGlobal(){let e=this;l.YUNJ_ADMIN_ENTRANCE=e.config("admin.entrance","admin")}config(e,n=null){e=e||"";if(YUNJ_CONFIG.hasOwnProperty(e)){return YUNJ_CONFIG[e]}let r=e.indexOf(".")===-1?[e]:e.split(".");if(r.length<=0)return n;let a=YUNJ_CONFIG||{};for(let t=0,e=r.length;t<e;t++){let e=r[t];if(!a.hasOwnProperty(e))return n;a=a[e]}YUNJ_CONFIG[e]=a;return a}shuffle(e){return yunj.arrayShuffle(Array.from(e)).join("")}fileUploadUrl(e="input"){if(!yunj.isString(e)||e.length<=0)e="input";return`${yunj.config("file.upload_url")}?from=${e}`}fileUpload(e,t="file",n="input"){let r=new FormData;r.append(t,e);return yunj.request({url:yunj.fileUploadUrl(n),data:r,type:"POST",processData:false,contentType:false})}defaultImageUrl(){return yunj.config("def.image_url")}isMobile(){return navigator.userAgent.toLowerCase().match(/(ipod|iphone|android|coolpad|mmp|smartphone|midp|wap|xoom|symbian|j2me|blackberry|wince)/i)!=null}isSmallScreen(){return top.window.innerWidth<=768}varType(e){return Object.prototype.toString.call(e).replace(/^\[object\s(.+)\]$/,"$1").toLowerCase()}isObj(e){return yunj.varType(e)==="object"&&!e.length}isEmptyObj(e){return e&&yunj.isObj(e)&&Object.keys(e).length<=0}isArray(e){return yunj.varType(e)==="array"}isEmptyArray(e){return yunj.isArray(e)&&e.length<=0}isPositiveIntArray(e){if(!yunj.isArray(e)||yunj.isEmptyArray(e))return false;let t=e.join(",");return/^[1-9]\d*(?:,[1-9]\d*)*$/.test(t)}isString(e){return yunj.varType(e)==="string"}isEmptyString(e){return yunj.isString(e)&&e.length<=0}isJson(t){if(!yunj.isString(t))return false;try{let e=JSON.parse(t);return e&&typeof e==="object"}catch(e){return false}}isBool(e){return yunj.varType(e)==="boolean"}isNumber(e){return yunj.varType(e)==="number"}isPositiveInt(e){return/(^[1-9]\d*$)/.test(e)}isPositiveInteger(e){return yunj.isPositiveInt(e)}isNonnegativeInt(e){return/^([1-9]\d*|0)$/.test(e)}isNonnegativeInteger(e){return yunj.isNonnegativeInt(e)}isNonnegativeNum(e){return yunj.defaultRegex.nonnegativeNum.test(e)}isNonnegativeNumber(e){return yunj.isNonnegativeNum(e)}isFloat(e){return e%1!==0}isScalar(e){let t=yunj.varType(e);return["string","number","boolean"].indexOf(t)!==-1}isUndefined(e){return"undefined"===yunj.varType(e)}isFunction(e){return"function"===yunj.varType(e)}isJQueryEl(e){return yunj.varType(e)==="object"&&e.hasOwnProperty("length")&&yunj.isNumber(e.length)&&typeof e.each==="function"}isCsv(e){return"csv"===yunj.fileExt(e)}isXls(e){return yunj.fileExt(e)==="xls"}isXlsx(e){return yunj.fileExt(e)==="xlsx"}fileExt(e){let t=yunj.isString(e)?e:e.name;return t.substr(t.lastIndexOf(".")+1)}fileNameExt(e,t){e=e.lastIndexOf(".")!==-1?e.substr(0,e.lastIndexOf(".")):e;let n=yunj.fileExt(t);return e+"."+n}str_pad(e,t,n="",r="left"){e=e.toString();n=n.toString();let a=e.length;while(a<t){e=r==="left"?n+e:e+n;a++}return e}str_to_array_buffer(t){let e=new ArrayBuffer(t.length);let n=new Uint8Array(e);for(let e=0;e!==t.length;++e)n[e]=t.charCodeAt(e)&255;return e}isTimestamp(e,t=false){let n=t?/^[1-9]\d{0,12}$/:/^[1-9]\d{0,9}$/;return yunj.isScalar(e)&&e&&n.test(e)}isDate(e){if(!e||!yunj.isString(e))return false;let t=e.match(/^(\d+)[-|/](\d{1,2})[-|/](\d{1,2})$/);if(!yunj.isArray(t)||t.length!==4)return false;t[2]=t[2]-1;let n=new Date(t[1],t[2],t[3]);return!isNaN(n.getTime())&&n.getFullYear()===(t[1]|0)&&n.getMonth()===(t[2]|0)&&n.getDate()===(t[3]|0)}isDatetime(e){if(!e||!yunj.isString(e))return false;let t=e.match(/^(\d+)[-|/](\d{1,2})[-|/](\d{1,2})\s(\d{1,2}):(\d{1,2}):(\d{1,2})$/);if(!yunj.isArray(t)||t.length!==7)return false;t[2]=t[2]-1;let n=new Date(t[1],t[2],t[3],t[4],t[5],t[6]);return!isNaN(n.getTime())&&n.getFullYear()===(t[1]|0)&&n.getMonth()===(t[2]|0)&&n.getDate()===(t[3]|0)&&n.getHours()===(t[4]|0)&&n.getMinutes()===(t[5]|0)&&n.getSeconds()===(t[6]|0)}isYear(e){if(!e||!yunj.isString(e))return false;let t=e.match(/^(\d+)$/);if(!yunj.isArray(t)||t.length!==2)return false;let n=new Date(t[1]);return!isNaN(n.getTime())&&n.getFullYear()===(t[1]|0)}isYearMonth(e){if(!e||!yunj.isString(e))return false;let t=e.match(/^(\d+)[-|/](\d{1,2})$/);if(!yunj.isArray(t)||t.length!==3)return false;t[2]=t[2]-1;let n=new Date(t[1],t[2]);return!isNaN(n.getTime())&&n.getFullYear()===(t[1]|0)&&n.getMonth()===(t[2]|0)}isMonth(e){if(!e||!yunj.isPositiveInt(e))return false;return e>=1&&e<=12}isTime(e){if(!e||!yunj.isString(e))return false;let t=e.match(/^(\d{1,2}):(\d{1,2}):(\d{1,2})$/);if(!yunj.isArray(t)||t.length!==4)return false;let n=new Date(2019,5,15,t[1],t[2],t[3]);return!isNaN(n.getTime())&&n.getHours()===(t[1]|0)&&n.getMinutes()===(t[2]|0)&&n.getSeconds()===(t[3]|0)}isDatetimeVal(e){return yunj.isYear(e)||yunj.isMonth(e)||yunj.isYearMonth(e)||yunj.isTime(e)||yunj.isDate(e)||yunj.isDatetime(e)}datetimeToTimestamp(e,t=false){let n=new Date(e).getTime();if(isNaN(n))return 0;return t?n:parseInt(n/1e3)}currTimestamp(e=false){let t=(new Date).getTime();return e?t:parseInt(t/1e3)}currDatetime(){let e=parseInt((new Date).getTime()/1e3);return yunj.timestampFormat(e)}timestampFormat(e,t="Y-m-d H:i:s"){if(!yunj.isTimestamp(e)&&!yunj.isTimestamp(e,true))return"";e=parseInt(e);e=e<=9999999999?e*1e3:e;let n=new Date(e);let r=n.getFullYear();let a=yunj.str_pad(n.getMonth()+1,2,0,"left");let i=yunj.str_pad(n.getDate(),2,0,"left");let l=yunj.str_pad(n.getHours(),2,0,"left");let u=yunj.str_pad(n.getMinutes(),2,0,"left");let s=yunj.str_pad(n.getSeconds(),2,0,"left");return t.replace(/Y|m|d|H|i|s/gi,function(e){return{Y:r,m:a,d:i,H:l,i:u,s:s}[e]})}getWeekStartDateObj(e){let t=yunj.isTimestamp(e)?e:yunj.datetimeToTimestamp(e,true);t=t<=9999999999?t*1e3:t;let n=new Date(t);let r=n.getDay();let a=t-(r===0?0:r-1)*864e5;let i=new Date(a);return new Date(i.getFullYear(),i.getMonth(),i.getDate())}getCurrWeekStartDateObj(){let e=yunj.currTimestamp(true);return yunj.getWeekStartDateObj(e)}getWeekEndDateObj(e){let t=yunj.isTimestamp(e)?e:yunj.datetimeToTimestamp(e,true);t=t<=9999999999?t*1e3:t;let n=new Date(t);let r=n.getDay();let a=t+(r===0?0:7-r)*864e5;let i=new Date(a);return new Date(i.getFullYear(),i.getMonth(),i.getDate(),23,59,59,999)}getLastWeekStartDateObj(){let e=yunj.currTimestamp(true)-7*864e5;return yunj.getWeekStartDateObj(e)}getLastWeekEndDateObj(){let e=yunj.currTimestamp(true)-7*864e5;return yunj.getWeekEndDateObj(e)}getCurrMonthStartDateObj(){let e=new Date;let t=e.getFullYear();let n=e.getMonth();return new Date(t,n)}getMonthsYearMonthDateObj(e){let t=new Date;let n=t.getFullYear();let r=t.getMonth();let a,i;let l=r+1+e;if(l===0){a=n-1}else{a=n+Math.floor(l/12)}if(e%12===0){i=r}else{i=(l>0?l%12:12+l%12)-1}return new Date(a,i)}getMonthsStartDateObj(e){return yunj.getMonthsYearMonthDateObj(e)}getMonthsEndDateObj(e){let t=yunj.getMonthsYearMonthDateObj(e);return new Date(t.getFullYear(),t.getMonth()+1,0,23,59,59,999)}getYearsStartDateObj(e){let t=new Date;let n=t.getFullYear()+e;return new Date(n,0,1)}getYearsEndDateObj(e){let t=new Date;let n=t.getFullYear()+e;return new Date(n,12,0,23,59,59,999)}getDaysDateObj(e){let t=yunj.currTimestamp(true);return new Date(t+e*864e5)}getMonthsTodayDateObj(e){let t=yunj.getMonthsYearMonthDateObj(e);let n=t.getFullYear();let r=t.getMonth();let a=new Date;let i=a.getDate();let l=new Date(n,r+1,0).getDate();let u=i<=l?i:l;let s=a.getHours();let o=a.getMinutes();let y=a.getSeconds();return new Date(n,r,u,s,o,y)}getYearsDateObj(e){let t=yunj.currTimestamp(true);return new Date(t+e*864e5*365)}getTimeDateObj(e,t=0,n=0,r=0){let a=new Date;a.setHours(e,t,n,r);return a}arrayShuffle(r){for(let n=r.length-1;n>0;n--){let e=Math.floor(Math.random()*(n+1));let t=r[n];r[n]=r[e];r[e]=t}return r}arrayColumn(r,e=null,a=null){let i=a?{}:[];for(let n=0;n<r.length;n++){let t=r[n];if(e){t=t[e]}if(a){let e=r[n][a];i[e]=t}else{i.push(t)}}return i}arrayDiff(e,t){return e.filter(e=>!t.includes(e))}arrayIntersect(e,t){return e.filter(e=>t.includes(e))}arrayUnique(e){if(e.length<=0)return[];let t=Array.from(new Set(e));return[...new Set(t)]}array_in(n=[],r=[]){if(yunj.isEmptyArray(r))return false;for(let e=0,t=n.length;e<t;e++){if(r.indexOf(n[e])===-1)return false}return true}array_slice(e=[],t=0){let n=[];let r=0;while(r<e.length){n.push(e.slice(r,r+=t))}return n}objSupp(t,n){for(let e in n){if(t.hasOwnProperty(e)){if(yunj.isObj(n[e])&&!yunj.isEmptyObj(n[e])&&yunj.isObj(t[e])){t[e]=yunj.objSupp(t[e],n[e])}}else{t[e]=n[e]}}return t}trim(e){return e.replace(/(^\s*)|(\s*$)/g,"")}ltrim(e){return e.replace(/(^\s*)/g,"")}rtrim(e){return e.replace(/(\s*$)/g,"")}domain(){return y.location.origin}url(e=false){return e?y.location.href:y.location.pathname+y.location.search}urlParam(r=null,e=null){let t=l.location.search.substring(1);let a=t.split("&");let i={};for(let n=0,e=a.length;n<e;n++){let e,t;[e,t]=a[n].split("=");if(r&&e===r)return t;if(!r)i[e]=t}return r?e:yunj.isEmptyObj(i)?e:i}urlPushParam(n,e,t){if(yunj.isObj(e)&&!yunj.isEmptyObj(e)){let t=e;for(let e in t){n=yunj.urlPushParam(n,e,t[e])}return n}let r=new RegExp("([?&])"+e+"=.*?(&|$)","i");let a=n.indexOf("?")!==-1?"&":"?";return n.match(r)?n.replace(r,"$1"+e+"="+t+"$2"):n+a+e+"="+t}handlePageUrl(e){let t=yunj.urlParam("originLocation");if(t===null)return e;return yunj.urlPushParam(e,"originLocation",t)}urlAppendDomain(e,t=""){if(e.substr(0,1)==="/"){if(!t){t=yunj.domain()}e=t+e}return e}urlFileName(e,t=true){let n=e.lastIndexOf("/");let r=e;if(n!==-1){r=r.substr(n+1)}if(t){return r}n=e.lastIndexOf(".");if(n!==-1){r=r.substr(0,n+1)}return r}xlsx_sheet_cell_wch(n){let r=0;for(let e=0,t=n.length;e<t;e++){r+=n.charCodeAt(e)>255?2:1}return r}isExistParent(){return l.parent!==l}currPageTitle(e=false){let t=e?".layui-layer-title":`.layui-tab-title li[lay-id=${n(yunj.url(true))}]`;return c(t,top.document).prop("firstChild").nodeValue}openNewPage(e){yunj.isExistParent()?top.window.open(e):l.open(e)}openTab(e,t="",n=false){n=n===true?yunj.currTabPageId():yunj.isString(n)?n:null;top.yunj.page.openTab(e,t,n)}openPopup(e,t="",n=false,r=null,a=null){n=n===true?yunj.currTabPageId():yunj.isString(n)?n:null;top.yunj.page.openPopup(e,t,n,r,a)}rawPageWin(){let e=yunj.urlParam("rawPage","");if(e.length<=0)return null;let t=c(top.document).find(`iframe[tab-id=${e}]`);if(t.length<=0)return null;return t[0].contentWindow}rawTable(e=""){let t=yunj.rawPageWin();if(!t||!t.hasOwnProperty("yunj")||!yunj.isObj(t.yunj)||!t.yunj.hasOwnProperty("table")||!yunj.isObj(t.yunj.table))return null;e=e?e:yunj.urlParam("rawTable","");return e?t.yunj.table[e]:null}redirectTab(e=null){return yunj.isExistParent()?top.yunj.page.redirectTab(e):yunj.page.redirectTab(e)}redirectLogin(){let e=yunj.config("admin.login_url","");yunj.isExistParent()?top.window.location.href=e:location.href=e}isPopupPage(){return yunj.isExistParent()&&yunj.urlParam("isPopup","no")==="yes"}isTabPage(){return yunj.isExistParent()&&!yunj.isPopupPage()}currTabPageId(){return yunj.isExistParent()?top.yunj.page.currTabPageId():""}currPopupPageId(){return yunj.isExistParent()?top.yunj.page.currPopupPageId():""}currPageId(){if(!yunj.isExistParent())return"";return yunj.isPopupPage()?top.yunj.page.currPopupPageId():top.yunj.page.currTabPageId()}msg(e,t=null,n=1500){let r={time:n};if(yunj.icon.hasOwnProperty(t))r.icon=yunj.icon[t];return top.layer.msg(e,r)}alert(e,t={},n=null){t=Object.assign({},{title:"提示",shadeClose:true},t);if(t.hasOwnProperty("icon")&&yunj.icon.hasOwnProperty(t.icon)){t.icon=yunj.icon[t.icon]}return top.layer.alert(e,t,n)}error(e,t=null){let n="";if(yunj.isString(e)){n=e}else if(e instanceof Error){n=e.message}else if(yunj.isObj(e)){n=e.hasOwnProperty("msg")?e.msg:JSON.stringify(e)}if(n)yunj.alert(n,{icon:yunj.icon.error},t)}confirm(e,t=null,n=null){let r={content:"",yesCallback:null,cancelCallback:null,title:"提示",icon:null};if(yunj.isObj(e)){r=yunj.objSupp(e,r)}else{r.content=e;r.yesCallback=t;r.cancelCallback=n}let a=r.content;let i={title:r.title};if(r.icon!==null)i.icon=r.icon;let l=e=>{top.layer.close(e);r.yesCallback&&r.yesCallback()};let u=e=>{top.layer.close(e);r.cancelCallback&&r.cancelCallback()};return top.layer.confirm(a,i,l,u)}open(e){return top.layer.open(e)}load(){return top.layer.load(2,{time:60*60*1e3})}load_rate(i={}){i=yunj.objSupp(i,{load_tips:"努力加载中...",success_tips:"已完成",auto_close:true,rate_callback:function(){return[99,100]}});let e={title:false,shade:.2,btn:[],closeBtn:0,time:60*60*1e3,skin:"yunj-load-rate",content:`<div class="load-box">
                            <i class='layui-icon layui-icon-loading layui-anim layui-anim-rotate layui-anim-loop'></i>
                            <span class="load-tips">努力加载中...</span>
                            <span class="load-rate">0%</span>
                        </div>`,success:function(r,a){r.find(".load-tips").html(i.load_tips);yunj.load_rate_timer=setInterval(function(){let[e,t]=i.rate_callback();let n=Math.floor(e/t*100);n=n>100?100:n;r.find(".load-rate").html(`${n}%`);if(n<100)return;r.find(".load-tips").html(i.success_tips);setTimeout(function(){yunj.load_rate_timer&&clearInterval(yunj.load_rate_timer)&&(yunj.load_rate_timer=null)},1e3);if(i.auto_close)yunj.close(a)},500)},end:function(){yunj.load_rate_timer&&clearInterval(yunj.load_rate_timer)&&(yunj.load_rate_timer=null)}};return yunj.isExistParent()?top.layer.open(e):d.open(e)}loadProgress(n={}){return new Promise((e,t)=>{layui.use(["loadProgress"],()=>{e(layui.loadProgress(n))})})}download(e,t=""){if(!yunj.isObj(e)&&!t){t=yunj.urlFileName(e)}layui.use(["download"],()=>{layui.download(e,t)})}tableExport(e){layui.use(["tableExport"],()=>{layui.tableExport(e)})}defaultImageAttrOnerror(){return`onerror="this.src='${yunj.defaultImageUrl()}';this.onerror=null;"`}previewImgStyle(t,n=0){return new Promise((u,e)=>{n=yunj.objSupp(n,{width:110,height:110});let s=n.width;let o=n.height;let y=new Image;y.src=t;y.onerror=function(){console.log("预览图片加载失败",t);y.src=yunj.defaultImageUrl()};y.onload=()=>{let t=y.width;let n=y.height;let r=s/t;let a=o/n;if(r<1&&a<1||r<1&&a>=1||a<1&&r>=1){let e=r<a?r:a;t=t*e|0;n=n*e|0}let e=(s-t)*.5;e=e<0?0:e;let i=(o-n)*.5;i=i<0?0:i;t=`${t}px`;n=`${n}px`;e=`${e}px`;i=`${i}px`;let l=`style="width:${t};height:${n};margin-left: ${e};margin-top: ${i};"`;u(l)}})}previewImg(e,r=0){let a=yunj.isString(e)?[e]:e;if(a.length<=0)return 0;let t=yunj.isExistParent()?c(top.document).width():c(y).width();let n=yunj.isExistParent()?c(top.document).height():c(y).height();let i=t>n?.6:.9;let l=t>n?.6:1;let u=t*i|0;let s=u*l|0;let o={type:1,title:false,area:[`${u}px`,`${s}px`],shade:.2,shadeClose:true,content:'<div class="layui-carousel" id="preview_img_carousel_box" ><div carousel-item></div></div>',success:function(t,e){async function n(){let n="";for(let e=0,t=a.length;e<t;e++){await(r=>{return new Promise((n,e)=>{yunj.previewImgStyle(r,{width:u,height:s}).then(function(e){let t=`<div><img src="${r}" alt="" ${e}></div>`;n(t)})}).then(e=>{n+=e})})(a[e])}return n}n().then(e=>{c(t).find("#preview_img_carousel_box div[carousel-item]").html(e);layui.use("carousel",function(){let e=layui.carousel;e.render({elem:c(t).find("#preview_img_carousel_box"),width:"100%",height:"100%",arrow:"always",autoplay:false,index:r});c(t).find("#preview_img_carousel_box").on("touchstart",function(e){let n=e.originalEvent.targetTouches[0].pageX;c(this).on("touchmove",function(e){arguments[0].preventDefault()});c(this).on("touchend",function(e){let t=e.originalEvent.changedTouches[0].pageX;e.stopPropagation();if(t-n>30){c(this).find(".layui-carousel-arrow[lay-type=sub]").click()}if(n-t>30){c(this).find(".layui-carousel-arrow[lay-type=add]").click()}c(this).off("touchmove touchend")})})})})}};return yunj.isExistParent()?top.layer.open(o):d.open(o)}close(e){if(e.length===32&&yunj.isTabPage()){yunj.isExistParent()?top.yunj.page.closeTab(e):yunj.page.closeTab(e)}else{top.layer.close(e)}}closeCurr(){let e=yunj.isTabPage()?yunj.currTabPageId():yunj.isExistParent()?top.layer.getFrameIndex(l.name):d.getFrameIndex(l.name);if(e)yunj.close(e)}closeAll(){c(".layui-tab-title li[lay-id]",top.document).find(".layui-tab-close").click();yunj.isExistParent()?top.layer.closeAll():d.closeAll()}request(e,t=null,n="get"){let r={url:"",data:null,headers:{},type:"get",dataType:"json",loading:false,complete:null};if(yunj.isObj(e)){r=Object.assign({},r,e)}else{r.url=e;r.data=t;r.type=n}let a={enable:false,tips:""};if(yunj.isBool(r.loading))a.enable=r.loading;else if(yunj.isObj(r.loading))a=yunj.objSupp(r.loading,a);r.loading=a;return yunj.ajaxRequest(r)}ajaxRequest(a){return new Promise((n,r)=>{if(a.loading.enable)a.loading.index=a.loading.tips?yunj.msg(a.loading.tips,"load",60*60*1e3):yunj.load();let e={url:a.url,data:a.data,headers:a.headers,type:a.type,cache:false,dataType:a.dataType,success:function(e,t){if(yunj.isObj(e)&&e.hasOwnProperty("errcode")&&yunj.isNumber(e.errcode)&&e.errcode!==0){if(e.errcode===yunj.config("def.confirm_errcode")){yunj.responseConfirmHandle(n,r,a,e);return}r(e)}else{yunj.responseSuccessMsg(e);n(e)}},error:function(e,t,n){r({errcode:1e4,msg:"网络异常",data:null})},complete:function(e,t){if(a.loading.enable)yunj.close(a.loading.index);a.complete&&a.complete(e,t)}};if(a.hasOwnProperty("processData")){e.processData=a.processData}if(a.hasOwnProperty("contentType")){e.contentType=a.contentType}c.ajax(e)})}responseConfirmHandle(t,n,e,r){yunj.confirm(r.msg,function(){if(!e.headers){e.headers={}}e.headers[yunj.config("def.confirmed_header_key")]=true;yunj.ajaxRequest(e).then(e=>{t(e)}).catch(e=>{n(e)})},function(){t(r)})}responseSuccessMsg(e){if(e.errcode===0&&e.msg!==yunj.config("def.success_msg")){yunj.msg(e.msg)}}formField(t,n={}){if(yunj.isFunction(t)){n.args.html=t(n.formId);t="custom"}n=Object.assign({},{formId:null,tab:"",key:"",args:{}},n);return new Promise(e=>{t=`FormField${t.slice(0,1).toUpperCase()+t.slice(1)}`;layui.use(t,()=>{e(new layui[t](n))})})}formClear(e){c(y).trigger(`yunj_form_${e}_clear`)}formReset(e){c(y).trigger(`yunj_form_${e}_reset`)}formData(e,t=null){let n={};let r={enable:!!t,rule:{},data:{},dataTitle:{}};c(y).trigger(`yunj_form_${e}_submit`,[n,r]);if(r.enable)t.rule(r.rule).checkTips(r.data,r.dataTitle);return n}formObj(e){if(yunj.hasOwnProperty("form")&&yunj.form.hasOwnProperty(e)){return yunj.form[e]}return null}generateFormFieldId(e,t){let n=this;return e+`_${t}`}tableCol(n,r){return new Promise((e,t)=>{try{n=/\s/.test(n)?"TableColCustom":`TableCol${n.slice(0,1).toUpperCase()+n.slice(1)}`;layui.use(n,()=>{e(new layui[n](r))})}catch(e){console.log(e)}})}async includeJs(n){let e=false;if(c(`script[src='${n}']`).length>0)e=true;if(e)return"done";await new Promise(e=>{let t=y.createElement("script");t.type="text/javascript";t.async=true;t.src=n;t.onload=function(){e("done")};y.getElementsByTagName("head")[0].appendChild(t)});return"done"}async includeCss(n){let e=false;if(c(`link[href='${n}']`).length>0)e=true;if(e)return"done";await new Promise(e=>{let t=y.createElement("link");t.type="text/css";t.rel="stylesheet";t.async=true;t.href=n;t.onload=function(){e("done")};y.getElementsByTagName("head")[0].appendChild(t)});return"done"}async includeXlsxStyle(){await yunj.includeJs("/static/yunj/libs/xlsx_style/libs/xlsx.core.min.js");await yunj.includeJs("/static/yunj/libs/xlsx_style/libs/xlsx.style.min.js");return"done"}file_content(n,r="json"){n=yunj.urlPushParam(n,"v",l.YUNJ_VERSION);return new Promise((t,e)=>{c.ajax({url:n,type:"get",dataType:r,cache:true,success:function(e){t(e)},error:function(){e("unknow error")}})})}area_options(){return new Promise((t,e)=>{if(yunj.hasOwnProperty("attr_area_options")&&yunj.isObj(yunj.attr_area_options)){t(yunj.attr_area_options)}else{yunj.file_content("/static/yunj/json/area.json").then(e=>{yunj.attr_area_options=e;t(yunj.attr_area_options)})}})}icon_options(){return new Promise((t,e)=>{if(yunj.hasOwnProperty("attr_icon_options")&&yunj.isArray(yunj.attr_icon_options)){t(yunj.attr_icon_options)}else{yunj.file_content("/static/yunj/json/icon.json").then(e=>{yunj.attr_icon_options=e;t(yunj.attr_icon_options)})}})}copy(e){if(!yunj.isString(e)||e.length<=0)return false;let t=y.createElement("input");t.value=e;y.body.appendChild(t);t.select();y.execCommand("Copy");t.remove();yunj.msg("复制成功",null,500);return true}async markdownToHtml(e,t){let n={markdown:"",htmlDecode:"style,script,iframe",tocm:true,emoji:true,taskList:true,tex:true,flowChart:true,sequenceDiagram:true};if(yunj.isString(t))t={markdown:t};t=Object.assign({},n,t||{});l.jQuery=c;l.$=c;await yunj.includeCss("/static/yunj/libs/editor.md/css/editormd.preview.css");await yunj.includeJs("/static/yunj/libs/editor.md/lib/marked.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/lib/prettify.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/lib/raphael.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/lib/underscore.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/lib/sequence-diagram.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/lib/flowchart.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/lib/jquery.flowchart.min.js");await yunj.includeJs("/static/yunj/libs/editor.md/editormd.min.js");await yunj.tryExec(function(){editormd.markdownToHTML(e,t)})}randStr(t=32){let n="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789abcdefghijklmnopqrstuvwxyz";let r=n.length;let a="";for(let e=0;e<t;e++)a+=n.charAt(Math.floor(Math.random()*r));return a}async aesEncrypt(t,n,r){await yunj.includeJs("/static/yunj/libs/crypto-js/crypto-js.js");return await yunj.tryExec(function(){t=CryptoJS.enc.Utf8.parse(t);n=CryptoJS.enc.Utf8.parse(n.substr(0,16));r=CryptoJS.enc.Utf8.parse(r.substr(0,16));let e=CryptoJS.AES.encrypt(t,n,{iv:r,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return btoa(e.toString())})}async aesDecrypt(t,n,r){await yunj.includeJs("/static/yunj/libs/crypto-js/crypto-js.js");return await yunj.tryExec(function(){n=CryptoJS.enc.Utf8.parse(n.substr(0,16));r=CryptoJS.enc.Utf8.parse(r.substr(0,16));let e=CryptoJS.AES.decrypt(atob(t),n,{iv:r,mode:CryptoJS.mode.CBC,padding:CryptoJS.pad.Pkcs7});return e.toString(CryptoJS.enc.Utf8)})}async rsaEncrypt(t,n){await yunj.includeJs("/static/yunj/libs/jsencrypt/bin/jsencrypt.min.js");return await yunj.tryExec(function(){let e=new JSEncrypt;e.setPublicKey(n);return e.encrypt(t)})}async rsaDecrypt(t,n){await yunj.includeJs("/static/yunj/libs/jsencrypt/bin/jsencrypt.min.js");return await yunj.tryExec(function(){let e=new JSEncrypt;e.setPrivateKey(n);return e.decrypt(t)})}async rsaSign(t,n){await yunj.includeJs("/static/yunj/libs/crypto-js/crypto-js.js");await yunj.includeJs("/static/yunj/libs/jsencrypt/bin/jsencrypt.min.js");return await yunj.tryExec(function(){let e=new JSEncrypt;e.setPrivateKey(n);return e.sign(t,CryptoJS.SHA1,"sha1")})}async rsaSignVerify(t,n,r){await yunj.includeJs("/static/yunj/libs/crypto-js/crypto-js.js");await yunj.includeJs("/static/yunj/libs/jsencrypt/bin/jsencrypt.min.js");return await yunj.tryExec(function(){let e=new JSEncrypt;e.setPublicKey(r);return e.verify(t,n,CryptoJS.SHA1)})}async tryExec(e,t=200){if(!yunj.isFunction(e))return;while(true){try{return e()}catch(e){await new Promise(e=>setTimeout(e,t))}}}uppercaseToUnderline(e){return e.replace(/(?<=[a-z])([A-Z])/,"_$1").toLowerCase()}underlineToUppercase(e,n=false){let r=e.split("_");let a=n?"":r[0];for(let e=n?0:1,t=r.length;e<t;e++){a+=r[e].slice(0,1).toUpperCase()+r[e].slice(1)}return a}md5(e){return n(e)}fileToBase64(n){return new Promise(t=>{let e=new FileReader;e.readAsDataURL(n);e.onload=e=>{t(e.target.result)}})}parseBase64(e){let t=e.split(",");let n=t[0].match(/:(.*?);/)[1];return{mime:n,data:t[1]}}base64ToUint8Array(e){let t=yunj.parseBase64(e);let n=atob(t.data);let r=n.length;let a=new Uint8Array(r);while(r--){a[r]=n.charCodeAt(r)}return a}base64ToBlob(e){let t=yunj.parseBase64(e);let n=yunj.base64ToUint8Array(e);return new Blob([n],{type:t.mime})}blobToFile(e){let t=new Date;e.lastModifiedDate=t;e.lastModified=t.getTime();e.name=e.type.replace("/",".");return e}base64ToFile(n){let r=null;if(l.File!==undefined){let e=yunj.parseBase64(n);let t=yunj.base64ToUint8Array(n);r=new File([t],e.mime.replace("/","."),{type:e.mime})}else{r=yunj.blobToFile(yunj.base64ToBlob(n))}return r}setLocalStorage(e,t,n=0){t=JSON.stringify({ttl:n,setTime:yunj.currTimestamp(),value:t});localStorage.setItem(e,t)}getLocalStorage(e,t=""){let n=localStorage.getItem(e);if(n===null)return t;n=JSON.parse(n);if(n.ttl>0&&yunj.currTimestamp()>n.setTime+n.ttl){yunj.clearLocalStorage(e);return t}return n.value}clearLocalStorage(...e){if(e.length<=0){localStorage.clear();return}e.forEach(e=>{localStorage.removeItem(e)})}iconClass(e){if(!e||!yunj.isString(e)){return e}if(e.indexOf("layui-icon-")!==-1&&e.indexOf("layui-icon ")===-1){e="layui-icon "+e}else if(e.indexOf("yunj-icon-")!==-1&&e.indexOf("yunj-icon ")===-1){e="yunj-icon "+e}return e}ucfirst(e){if(!yunj.isString(e)||!e){return e}return e.slice(0,1).toUpperCase()+e.slice(1)}isBase64(e){if(!e||!yunj.isString(e)){return false}try{return l.btoa(l.atob(e))===e}catch(e){return false}}base64Encode(e){const t=new TextEncoder;const n=t.encode(e);return btoa(String.fromCharCode(...new Uint8Array(n)))}base64Decode(e){if(!yunj.isBase64(e)){return e}let t=new TextDecoder("utf-8");let n=atob(e);return t.decode(new Uint8Array(n.split("").map(e=>e.charCodeAt(0))))}generateGridClass(n){let r="";let s=["xs","sm","md","lg","xl"];for(let t=0;t<n.length;t++){let e=s[t];if(!e){break}let a=yunj.trim(n[t].toString()).replace(/\s+/g," ").split(" ");let i=null;let l=null;let u=null;for(let r=0;r<a.length;r++){let e=a[r];if(!e){continue}if(yunj.isPositiveInt(e)&&e<=12){i=e;continue}let t=e.substr(0,1);let n=e.substr(1);if((t==="l"||t==="r")&&yunj.isPositiveInt(n)&&n<=12){if(t==="l"){l=n}else{u=n}}}if(!i){continue}r+=` layui-col-${e+i}`;if(l){r+=` layui-col-${e}-offset${l}`}if(u){r+=` yunj-col-${e}-offset${u}`}}return r}getLoginMemberId(){let e=c(top.document).find("#member_id");let t;if(e.length>0){t=e.val()}return t||0}}if(!l.hasOwnProperty("yunj")||!yunj.hasOwnProperty("version"))l.yunj=new t;e("yunj",l.yunj)});